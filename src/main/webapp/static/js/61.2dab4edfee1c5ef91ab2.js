webpackJsonp([61],{"3ofQ":function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,"\n.repeatFiles[data-v-1d831a52] {\n  border: 1px solid #eee;\n  margin-top: 20px;\n}\n.notCommit[data-v-1d831a52] {\n  color: #909399;\n}\n.auditing[data-v-1d831a52] {\n  color: #409eff;\n}\n.pass[data-v-1d831a52] {\n  color: #67c23a;\n}\n.reject[data-v-1d831a52] {\n  color: #f56c6c;\n}\n",""])},AKbO:function(e,t,i){var o=i("3ofQ");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i("rjj0")("7e866d83",o,!0)},T6ub:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("//Fk"),l=i.n(o),a=i("mvHQ"),s=i.n(a),n=i("I1uT"),r=i("K+sb"),d=i("rV10"),c=i("XlQU"),p=i("vLgD"),u=i("JSQk"),f=i.n(u),h=i("pxDI"),m=i("mw3O"),v=i.n(m),g={name:"comFileManage",props:{selectCompId:{type:String},selectCompName:{type:String},forUse:{type:String,default:"normal"},proClass:{type:Number}},data:function(){return{ip:"",port:"",userId:"",projectId:"",componentId:"",parentNodeId:"",newFolderName:"",selectFileId:"",errorMessage:"操作失败",maniType:"",fileRename:{name:""},fileEditInfo:{secretClass:null,type:null,productNo:null,fileNo:null},fileUpInfo:{secretClass:null,type:null,productNo:null,fileNo:null},userSecurity:null,secretClassOptions:[{label:"公开",value:0},{label:"内部",value:1},{label:"秘密",value:2},{label:"机密",value:3}],typeOptions:[{label:"参数文件",value:"0"},{label:"模型文件",value:"1"},{label:"报告文件",value:"2"},{label:"实验数据",value:"3"}],codeNameOptions:[{label:"产品型号",value:0},{label:"文件图号",value:1}],uploadDialog:!1,renameDialog:!1,maniFileDialog:!1,editInfoDialog:!1,fileList:[],breadcrumbList:[],tableKey:0,list:[],listApproved:[],singleComp:null,total:null,listLoading:!0,approveListLoading:!0,uploading:!1,upFileLoading:!1,fileRenameRules:{name:[{required:!0,message:"请输入文件名！",trigger:"blur"}]},maniFileLoading:!1,options:{target:"http://127.0.0.1:8080/files/chunks",headers:{Authorization:""},chunkSize:52428800,simultaneousUploads:20,autoStart:!1,testChunks:!0,singleFile:!1},attrs:{accept:"image/*"},statusText:{computeMD5:"正在计算MD5",success:"上传结束",error:"出错了",uploading:"上传中",paused:"暂停中",waiting:"等待中"},md5Loading:!1,started:!1,autoStart:!1,files:[],fileInfo:[],searchQuery:"",target:"",token:"",fileInfoList:[],fileCompleteLength:0,stopResolveMD5:!1,hiddenClose:!1,libOptions:[],selectedFiles:[],selectedFileIds:[],commitDialog:!1,signType:0,activeNames:"",getMaLoading:!1,userList:[],countersignList:[],verifyMembers:[],auditMembers:[],signMembers:[],approveMembers:[],repeatFiles:[],filiterStateList:[{text:"未提交",value:"notCommit"},{text:"审核中",value:"auditing"},{text:"审核通过",value:"pass"},{text:"审核驳回",value:"deny"}],uploadType:"normal",selectedFileId:"",versionOptions:[{value:"M"},{value:"C"},{value:"S"},{value:"D"}],ifToStartOptions:[{label:"提交到初始审核流程",value:!0},{label:"提交到被驳回的审核流程",value:!1}],fileModify:{version:"",versionNum:1,ifToStart:null},currentVersion:"",versionSelectDialog:!1,switchVersion:"",switchVersionOptions:[],commitLoading:!1,targetEditFile:{},historyFileDialog:!1,historyLoading:!0,historyFiles:[],typeMap:{0:"参数文件",1:"模型文件",2:"报告文件",3:"实验数据"},showOnlyEdit:!1}},created:function(){this.ip=this.getCookie("ip"),this.port=this.getCookie("port"),this.userId=this.getCookie("userId"),this.target=p.a.defaults.baseURL+"/files/chunks",this.token="Bearer"+this.$store.getters.token,this.selectFileId="",this.maniType="",this.initData()},methods:{checkUserInfo:function(){var e=this;null===this.userSecurity&&Object(c.h)(this.userId).then(function(t){0===t.data.code&&(e.userSecurity=t.data.data.secretClass)})},refreshFileList:function(){var e=this;Object(d.g)(this.componentId,this.userId).then(function(t){0===t.data.code&&(e.list=t.data.data)})},getAbleUser:function(){var e=this;this.getMaLoading=!0,Object(c.d)().then(function(t){if(0===t.data.code){e.userList=[],t.data.data.forEach(function(t){"admin"!==t.username&&"securityGuard"!==t.username&&"securityAuditor"!==t.username&&e.userList.push(t)}),e.countersignList=e.userList.slice(0);for(var i=0;i<e.countersignList.length;i++)if(e.countersignList[i].id===e.userId){e.countersignList.splice(i,1);break}e.getMaLoading=!1}else e.getMaLoading=!1}).catch(function(){e.getMaLoading=!1})},initData:function(){this.projectId=this.$store.getters.projectId,this.componentId=this.selectCompId,this.compName=this.selectCompName,this.breadcrumbList=[],this.list=[],this.breadcrumbList.push({name:this.compName,componentId:this.componentId,parentNodeId:"",folder:!0}),this.componentId?this.getList():this.listLoading=!1,this.autoStart=!1},getList:function(){var e=this;this.listLoading=!0,Object(d.g)(this.componentId,this.userId).then(function(t){0===t.data.code&&(e.list=t.data.data,e.listLoading=!1)}).catch(function(){e.listLoading=!1,e.$notify({title:"失败",message:"加载出错！",type:"error",duration:2e3})}),Object(d.l)(this.componentId,!0).then(function(t){0===t.data.code&&(e.listApproved=t.data.data,e.approveListLoading=!1)}).catch(function(){e.approveListLoading=!1,e.$notify({title:"失败",message:"加载出错！",type:"error",duration:2e3})})},handleuploadFile:function(){var e=this;this.uploadType="normal",this.repeatFiles=[],this.uploadDialog=!0,this.hiddenClose=!1,this.$nextTick(function(){e.fileReader=new FileReader,e.$refs.uploader.uploader.cancel(),e.$refs.uploader.uploader.opts.target=e.target,e.$refs.uploader.uploader.opts.headers.Authorization=e.token,e.$refs.uploader.uploader.opts.singleFile=!1,$(".uploader-list ul").html(""),e.fileCompleteLength=0,e.fileInfoList=[],$(".manage-uploader .uploader-btn").css("display","inline-block")})},handleEditFile:function(e,t){var i=this;this.repeatFiles=[],this.selectedFileId=e.id,this.uploadType=t,this.showOnlyEdit=!0,this.currentVersion=e.version,this.targetEditFile=e,this.uploadDialog=!0,this.hiddenClose=!1,this.$nextTick(function(){i.fileReader=new FileReader,i.$refs.uploader.uploader.cancel(),i.$refs.uploader.uploader.opts.target=i.target,i.$refs.uploader.uploader.opts.headers.Authorization=i.token,i.$refs.uploader.uploader.opts.singleFile=!0,$(".uploader-list ul").html(""),i.fileCompleteLength=0,i.fileInfoList=[],$(".manage-uploader .uploader-btn").css("display","inline-block")})},checkFileIfSame:function(e){return this.targetEditFile.name+"."+this.targetEditFile.postfix===e.name&&this.targetEditFile.secretClass===this.fileUpInfo.secretClass&&this.targetEditFile.type===this.fileUpInfo.type&&this.targetEditFile.productNo===this.fileUpInfo.productNo&&this.targetEditFile.fileNo===this.fileUpInfo.fileNo},checkMd5:function(e,t){var i=this;if(this.showOnlyEdit=!1,this.repeatFiles=[],"normal"===this.uploadType||"normal"!==this.uploadType&&!this.checkFileIfSame(e[0])){for(var o=[],l=0;l<e.length;l++){var a={secretClass:this.fileUpInfo.secretClass,type:this.fileUpInfo.type,productNo:this.fileUpInfo.productNo,fileNo:this.fileUpInfo.fileNo,name:e[l].name,relativePath:"/"+e[l].relativePath};o.push(a)}var n=s()(o);Object(r.c)(this.componentId,this.userId,n).then(function(t){var o;0===t.data.code&&function(){i.repeatFiles=t.data.data;for(var l=e.length-1;l>=0;l--)for(var a=0;a<i.repeatFiles.length;a++)if(void 0===e[l]||e[l].name!==i.repeatFiles[a].name+"."+i.repeatFiles[a].postfix);else{var s=e[l];i.$refs.uploader.uploader.removeFile(s),i.fileCompleteLength+=1,e.splice(l,1)}i.repeatFiles.length>0&&i.$message({showClose:!0,message:"请注意，此次上传的文件中有"+i.repeatFiles.length+"个文件在库中已存在！",type:"warning"}),e.length>0&&(i.hiddenClose=!0,i.md5Loading=!0,$(".manage-uploader .uploader-btn").css("display","none")),i.fileCompleteLength+=e.length;var n=i.$refs.uploader.uploader.opts.chunkSize,r=0,d=i,c=function(){var t=e[o];i.resolveMd5(t,n).then(function(i){t.md5=i,t.uniqueIdentifier=i,Object(h.a)(t.md5).then(function(i){if(i.data.data.id){r++;var o={fileId:i.data.data.id,MD5:t.md5,name:t.name,relativePath:"/"+t.relativePath,secretClass:d.fileUpInfo.secretClass,type:d.fileUpInfo.type,productNo:d.fileUpInfo.productNo,fileNo:d.fileUpInfo.fileNo,sublibraryId:d.fileUpInfo.subLibraryId};d.fileInfoList.push(o);var l="",a=t.size;a<1024?l=a+" B":a>=1024&&a<1048576?l=Math.round(a/1024*10)/10+" KB":a>=1048576&&a<1073741824?l=Math.round(a/1048576*10)/10+" MB":a>=1073741824&&(l=Math.round(a/1073741824*10)/10+" G"),$(".manage-uploader .uploader-list ul").prepend('<div status="success" class="uploader-file"><div class="uploader-file-progress" style="transform: translateX(0%);"></div> <div class="uploader-file-info"><div class="uploader-file-name"><i icon="unknown" class="uploader-file-icon"></i>'+t.name+'</div> <div class="uploader-file-size">'+l+'</div> <div class="uploader-file-meta"></div> <div class="uploader-file-status"><span>成功了</span> <span style="display: none;"><span>100%</span> <em>0 bytes / s</em> <i></i></span></div> <div class="uploader-file-actions"><span class="uploader-file-pause"></span> <span class="uploader-file-resume">️</span> <span class="uploader-file-retry"></span> <span class="uploader-file-remove"></span></div></div></div>'),d.$refs.uploader.uploader.removeFile(t),d.fileCompleteLength+=1,d.listLoading=!1,r===e.length&&(d.md5Loading=!1,d.$refs.uploader.uploader.upload())}else 0==i.data.data&&++r===e.length&&(d.md5Loading=!1,d.$refs.uploader.uploader.upload())})})};for(o=0;o<e.length;o++)c()}()})}else{var d;!function(){e.length>0&&(i.hiddenClose=!0,i.md5Loading=!0,$(".manage-uploader .uploader-btn").css("display","none")),i.fileCompleteLength+=e.length;var t=i.$refs.uploader.uploader.opts.chunkSize,o=0,l=i,a=function(){var a=e[d];i.resolveMd5(a,t).then(function(t){console.log(t),a.md5=t,a.uniqueIdentifier=t,Object(h.a)(a.md5).then(function(t){if(t.data.data.id){o++;var i={fileId:t.data.data.id,MD5:a.md5,name:a.name,relativePath:"/"+a.relativePath,secretClass:l.fileUpInfo.secretClass,type:l.fileUpInfo.type,productNo:l.fileUpInfo.productNo,fileNo:l.fileUpInfo.fileNo,sublibraryId:l.fileUpInfo.subLibraryId};"normal"==l.uploadType&&(i.ifDirectModify=!1,i.ifBackToStart=!0),l.fileInfoList.push(i);var s="",n=a.size;n<1024?s=n+" B":n>=1024&&n<1048576?s=Math.round(n/1024*10)/10+" KB":n>=1048576&&n<1073741824?s=Math.round(n/1048576*10)/10+" MB":n>=1073741824&&(s=Math.round(n/1073741824*10)/10+" G"),$(".manage-uploader .uploader-list ul").prepend('<div status="success" class="uploader-file"><div class="uploader-file-progress" style="transform: translateX(0%);"></div> <div class="uploader-file-info"><div class="uploader-file-name"><i icon="unknown" class="uploader-file-icon"></i>'+a.name+'</div> <div class="uploader-file-size">'+s+'</div> <div class="uploader-file-meta"></div> <div class="uploader-file-status"><span>成功了</span> <span style="display: none;"><span>100%</span> <em>0 bytes / s</em> <i></i></span></div> <div class="uploader-file-actions"><span class="uploader-file-pause"></span> <span class="uploader-file-resume">️</span> <span class="uploader-file-retry"></span> <span class="uploader-file-remove"></span></div></div></div>'),l.$refs.uploader.uploader.removeFile(a),l.fileCompleteLength+=1,l.listLoading=!1,o===e.length&&(l.md5Loading=!1,l.$refs.uploader.uploader.upload())}else 0==t.data.data&&++o===e.length&&(l.md5Loading=!1,l.$refs.uploader.uploader.upload())})})};for(d=0;d<e.length;d++)a()}()}},resolveMd5:function(e,t){return new l.a(function(i,o){var l=e.file;if(e.md5)i(e.md5);else{e.status="computeMD5";var a=new f.a,s=new FileReader,n=(File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,Math.ceil(l.size/t)),r=0;s.onload=function(e){if(a.appendBinary(e.target.result),++r<n){d()}else i(a.end());s.onerror=function(e){return o(e)}};var d=function(){var e=r*t,i=e+t>=l.size?l.size:e+t;s.readAsBinaryString(l.slice(e,i))};d()}})},fileRemove:function(){this.fileCompleteLength-=1},mergeFile:function(e,t,o,l,a){var s=this,n={identifier:e,totalChunks:t,totalSize:o,filename:l,relativePath:a},r=i("mw3O").stringify(n);Object(h.b)(r).then(function(){}).catch(function(){s.$notify({})})},fileSuccess:function(){var e=arguments,t=this,i={identifier:arguments[1].uniqueIdentifier,totalChunks:arguments[1].chunks.length,totalSize:arguments[1].size,filename:arguments[1].name,relativePath:arguments[1].relativePath},o=v.a.stringify(i);this.listLoading=!0,Object(h.b)(o).then(function(i){if(0===i.data.code){var o={fileId:i.data.data.id,MD5:e[1].md5,name:e[1].name,relativePath:"/"+e[1].relativePath,secretClass:t.fileUpInfo.secretClass,type:t.fileUpInfo.type,productNo:t.fileUpInfo.productNo,fileNo:t.fileUpInfo.fileNo,sublibraryId:t.componentId,userId:t.userId};t.fileInfoList.push(o)}else t.$notify({title:"失败",message:"上传出错了！",type:"error",duration:2e3})})},fileComplete:function(){console.log("filecomplete=======")},deleteFile:function(e){var t=this;this.$confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.listLoading=!0,Object(d.c)(e.id).then(function(i){0===i.data.code?(t.getList(),t.$notify({title:"成功",message:e.name+"删除成功",type:"success",duration:2e3})):t.$notify({title:"失败",message:i.data.msg,type:"error",duration:2e3}),t.listLoading=!1}).catch(function(){t.listLoading=!1,t.$notify({title:"失败",message:"删除失败",type:"error",duration:2e3})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},previewFile:function(e){var t=this;Object(n.h)(e.id).then(function(e){if(0===e.data.code){if("picture"===e.data.data.fileType){var i=t.$router.resolve({path:"/preview",query:{id:e.data.data.pathId,type:e.data.data.fileType}}).href;window.open(i,"_blank")}if("office"===e.data.data.fileType){var o=p.a.defaults.baseURL+"/preview/viewer/document/"+e.data.data.pathId;window.open(o,"_blank")}}else t.$notify({title:"失败",message:e.data.msg,type:"error",duration:2e3})})},checkFileVersion:function(e){var t=this;this.historyLoading=!0,Object(d.k)(e.id).then(function(e){0===e.data.code&&(t.historyFiles=e.data.data,t.historyLoading=!1)}),this.historyFileDialog=!0},exportFile:function(e){var t=p.a.defaults.baseURL+"/sublibraryFiles/"+e.id+"/user/"+this.userId+"/export";window.open(t)},handleEditInfo:function(e){this.editInfoDialog=!0,this.selectFileId=e.id,this.fileEditInfo={secretClass:e.secretClass,type:e.type,codeName:e.codeName,productNo:e.productNo,fileNo:e.fileNo}},editFileInfo:function(){var e=this,t={secretClass:this.fileEditInfo.secretClass,type:this.fileEditInfo.type,productNo:this.fileEditInfo.productNo,fileNo:this.fileEditInfo.fileNo},o=i("mw3O").stringify(t);Object(d.d)(this.selectFileId,o).then(function(t){0===t.data.code?(e.$notify({title:"成功",message:"文件信息修改成功！",type:"success",duration:2e3}),e.editInfoDialog=!1,e.getList()):e.$notify({title:"失败",message:t.data.msg,type:"error",duration:2e3})})},onSubLibChange:function(e){this.fileUpInfo.subLibraryId=e[1]},handleSelectionChange:function(e){this.selectedFiles=e},handleVerifySelectionChange:function(e){this.verifyMembers=e},handleAuditSelectionChange:function(e){this.auditMembers=e},handleSignSelectionChange:function(e){this.signMembers=e},handleApproveSelectionChange:function(e){this.approveMembers=e},handleCommit:function(){0!==this.selectedFiles.length?(this.commitDialog=!0,this.signType=1,this.getAbleUser()):this.$message({message:"请先选择文件！",type:"warning"})},commitToAuditor:function(){var e=this,t=[],o=[],l=[],a=[],s=[];this.verifyMembers.forEach(function(e){t.push(e.id)}),this.auditMembers.forEach(function(e){o.push(e.id)}),this.signMembers.forEach(function(e){l.push(e.id)}),this.approveMembers.forEach(function(e){a.push(e.id)}),this.selectedFiles.forEach(function(e){s.push(e.id)});var n=(t+"").replace(/\[|]/g,""),r=(o+"").replace(/\[|]/g,""),c=(l+"").replace(/\[|]/g,""),p=(a+"").replace(/\[|]/g,""),u=(s+"").replace(/\[|]/g,""),f=i("mw3O"),h={sublibraryFileId:u,proofreadUserIds:n,auditUserIds:r,countersignUserIds:1===this.signType?"":c,approveUserIds:p,auditMode:this.signType},m=f.stringify(h);this.commitLoading=!0,Object(d.q)(this.selectedId,m).then(function(t){0===t.data.code?(e.$notify({title:"成功",message:"设置成功",type:"success",duration:2e3}),e.commitDialog=!1,e.getList(),e.selectedFiles=[]):e.$notify({title:"失败",message:t.data.msg,type:"error",duration:2e3}),e.commitLoading=!1}).catch(function(){e.$notify({title:"失败",message:"提交失败",type:"error",duration:2e3}),e.commitLoading=!1})},fileAuditSelection:function(e){return 0===e.state||8===e.state?1:0},getRowKey:function(e){return e.id},filterState:function(e,t){return"notCommit"==e?0===t.auditMode&&0===t.state:"auditing"==e?0!==t.auditMode&&!1===t.ifApprove&&!1===t.ifReject:"pass"==e?!0===t.ifApprove:"deny"==e?!0===t.ifReject:void 0},applyToEdit:function(e){var t=this;this.$confirm("确认申请修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var o={userId:t.userId},l=i("mw3O").stringify(o);Object(d.a)(e.id,l).then(function(e){0===e.data.code?(t.$notify({title:"成功",message:"申请成功！",type:"success",duration:"2000"}),t.getList()):t.$notify({title:"失败",message:e.data.msg,type:"error",duration:"2000"})})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},handleRevoke:function(e){var t=this;this.$confirm("确认撤销上次的修改吗吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.o)(e.id).then(function(e){0===e.data.code?(t.getList(),t.$notify({title:"成功",message:"撤销",type:"success",duration:2e3})):t.$notify({title:"失败",message:e.data.msg,type:"error",duration:2e3})}).catch(function(){t.$notify({title:"失败",message:"删除失败",type:"error",duration:2e3})})}).catch(function(){t.$message({type:"info",message:"已取消撤销操作"})})},handleRevokeSecond:function(e){var t=this;this.selectFileId=e.id,this.switchVersion="",this.currentVersion=e.version,Object(d.i)(e.id).then(function(e){0===e.data.code&&(t.switchVersionOptions=e.data.data,t.versionSelectDialog=!0)})},revokeSecondEdit:function(){var e=this,t={version:this.switchVersion},o=i("mw3O").stringify(t);Object(d.s)(this.selectFileId,o).then(function(t){0===t.data.code?(e.getList(),e.$notify({title:"成功",message:"版本更新成功",type:"success",duration:2e3})):e.$notify({title:"失败",message:t.data.msg,type:"error",duration:2e3})}).catch(function(){e.$notify({title:"失败",message:"删除失败",type:"error",duration:2e3})})},onlyModifyFileInfo:function(){var e=this;this.$confirm("确认仅修改文件信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={fileId:e.targetEditFile.files.id,MD5:e.targetEditFile.files.md5,name:e.targetEditFile.name,relativePath:"/"+e.targetEditFile.name+"."+e.targetEditFile.postfix,secretClass:e.fileUpInfo.secretClass,type:e.fileUpInfo.type,productNo:e.fileUpInfo.productNo,fileNo:e.fileUpInfo.fileNo,sublibraryId:e.targetEditFile.subDepot.id};"edit"===e.uploadType&&(t.ifDirectModify=!0,t.ifBackToStart=e.fileModify.ifToStart,t.version=""),"secondEdit"===e.uploadType&&(item.ifDirectModify=!1,item.ifBackToStart=!0,item.version=e.fileModify.version);var i=s()(t);Object(d.n)(e.selectedFileId,i).then(function(t){0===t.data.code?e.$notify({title:"成功",message:"文件信息修改并提交成功",type:"success",duration:2e3}):e.$notify({title:"失败",message:t.data.msg,type:"error",duration:2e3}),e.uploadDialog=!1}).catch(function(){e.$notify({title:"失败",message:"文件信息修改失败",type:"error",duration:2e3})})})}},computed:{classifyIcon:function(){return function(e){return 1==e.folder?"folder":"png"===e.files.type||"jpg"===e.files.type||"gif"===e.files.type?"image":"rar"===e.files.type||"zip"===e.files.type?"compressed":"file"}},computedSize:function(){return function(e){var t=void 0;return e<1024?t=e+"B":e>=1024&&e<1048576?t=Math.round(e/1024*10)/10+"KB":e>=1048576&&e<1073741824?t=Math.round(e/1048576*10)/10+"MB":e>=1073741824&&(t=Math.round(e/1073741824*10)/10+"G"),t}},computedSecret:function(){return function(e){return 0===e?"公开":1===e?"内部":2===e?"秘密":3===e?"机密":4===e?"绝密":void 0}},computeSecretOptions:function(){var e=this.secretClassOptions,t=this.userSecurity;return null!==this.userSecurity?e.filter(function(e){return e.value<=t}):[{label:"公开",value:0}]},fileInfoListLength:function(){return this.fileInfoList.length},computeList:function(){return 3===this.signType?this.countersignList:this.userList},computeAuditState:function(){return function(e){return 0===e.auditMode&&0===e.state?"未提交":0!==e.auditMode&&!1===e.ifApprove&&!1===e.ifReject&&8!==e.state||1===e.state?"审批中":!0===e.ifApprove&&6===e.state?"已通过":!0===e.ifReject&&6===e.state?"已驳回":7===e.state?"修改申请中":8===e.state?"二次修改中":9===e.state?"二次修改中":10===e.state?"二次修改审核中":void 0}},computeStateClass:function(){return function(e){return 0===e.auditMode&&0===e.state?"notCommit":!0===e.ifApprove?"approve":!0===e.ifReject||8===e.state?"reject":void 0}},computeVersionOption:function(){if("secondEdit"===this.uploadType){var e=[];if(this.currentVersion.length>0){var t=this.currentVersion.substring(0,1),i=void 0;return!0===this.targetEditFile.ifApprove?(i=parseInt(this.currentVersion.substring(1,this.currentVersion.length))+1,"M"===t&&(e=[{value:"M"+i},{value:"C1"}]),"C"===t&&(e=[{value:"C"+i},{value:"S1"}]),"S"===t&&(e=[{value:"S"+i},{value:"D1"}]),"D"===t&&(e=[{value:"D"+i}])):(i=parseInt(this.currentVersion.substring(1,this.currentVersion.length)),!0===this.targetEditFile.ifModifyApprove?(i+=1,"M"===t&&(e=[{value:"M"+i},{value:"C1"}]),"C"===t&&(e=[{value:"C"+i},{value:"S1"}]),"S"===t&&(e=[{value:"S"+i},{value:"D1"}]),"D"===t&&(e=[{value:"D"+i}])):("M"===t&&(e=[{value:"M"+i}]),"C"===t&&(e=[{value:"C"+i}]),"S"===t&&(e=[{value:"S"+i}]),"D"===t&&(e=[{value:"D"+i}]))),e}}},computeBtnDisable:function(){return function(e,t){var i=e.state,o=e.ifApprove,l=e.ifReject;return"delete"===t||"modifyInfo"===t?!(0===i&&0===e.auditMode||6===i&&!0!==o||8===i):"edit"===t?6!==i||!0!==l:"apply"===t?6!==i:"secondEdit"===t?8!==i:"revoke"===t?(6!==i||!0!==l)&&8!==i:"changeVersion"===t?(6!==i||!0!==l)&&8!==i:void 0}}},watch:{selectCompId:function(e,t){this.componentId=this.selectCompId,this.parentNodeId="",this.componentId&&this.initData()},selectCompName:function(e,t){this.componentId=this.selectCompId,this.parentNodeId="",this.componentId&&this.initData()},fileInfoListLength:function(e,t){var i=this;if(this.fileCompleteLength===this.fileInfoList.length&&0!==this.fileInfoList.length){var o=s()(this.fileInfoList);if(this.statusText.success="正在合并文件","normal"===this.uploadType)Object(d.r)(this.componentId,this.userId,o).then(function(e){0===e.data.code?(i.$notify({title:"成功",message:"上传成功",type:"success",duration:2e3}),i.statusText.success="文件合并成功"):(i.$notify({title:"成功",message:e.data.msg,type:"error",duration:2e3}),i.statusText.success="文件合并失败"),i.listLoading=!1,i.hiddenClose=!1,i.getList()}).catch(function(){i.listLoading=!1,i.hiddenClose=!1,i.$notify({title:"失败",message:"文件上传时出错",type:"error",duration:2e3}),i.statusText.success="文件合并失败",i.getList()});else if("secondEdit"===this.uploadType){this.fileInfoList.forEach(function(e){e.ifDirectModify=!1,e.ifBackToStart=!0,e.version=i.fileModify.version});var l=s()(this.fileInfoList[0]);Object(d.n)(this.selectedFileId,l).then(function(e){0===e.data.code?(i.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),i.statusText.success="文件修改成功"):(i.$notify({title:"成功",message:e.data.msg,type:"error",duration:2e3}),i.statusText.success="文件修改失败"),i.listLoading=!1,i.hiddenClose=!1,i.getList()}).catch(function(){i.listLoading=!1,i.hiddenClose=!1,i.$notify({title:"失败",message:"文件修改时出错",type:"error",duration:2e3}),i.statusText.success="文件修改失败",i.getList()})}else if("edit"===this.uploadType){this.fileInfoList.forEach(function(e){e.ifDirectModify=!0,e.ifBackToStart=i.fileModify.ifToStart,e.version=""});var a=s()(this.fileInfoList[0]);console.log(a),Object(d.n)(this.selectedFileId,a).then(function(e){0===e.data.code?(i.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),i.statusText.success="文件修改成功"):(i.$notify({title:"成功",message:e.data.msg,type:"error",duration:2e3}),i.statusText.success="文件修改失败"),i.listLoading=!1,i.hiddenClose=!1,i.getList()}).catch(function(){i.listLoading=!1,i.hiddenClose=!1,i.$notify({title:"失败",message:"文件修改时出错",type:"error",duration:2e3}),i.statusText.success="文件修改失败",i.getList()})}}}}},y={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fileComp"},[i("el-tabs",{attrs:{type:"border-card"}},[i("el-tab-pane",{attrs:{label:"已通过"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticClass:"fileList",staticStyle:{width:"100%"},attrs:{data:e.listApproved,"element-loading-text":"正在加载库文件",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"文件名","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[i("svg-icon",{staticStyle:{"font-size":"30px","margin-right":"10px",cursor:"pointer",color:"#26bada"},attrs:{"icon-class":e.classifyIcon(t.row)}}),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.name,placement:"top"}},[t.row.newFolder?e._e():i("span",{staticClass:"link-type",class:{repeatFile:t.row.repeat},staticStyle:{position:"relative",top:"2px",display:"inline-block",width:"70%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n                  "+e._s(t.row.name)+"\n                ")])])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"种类",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===t.row.folder||t.row.newFolder?e._e():i("span",[e._v("\n          "+e._s(t.row.files.postfix)+"\n        ")]),e._v(" "),1!=t.row.folder||t.row.newFolder?e._e():i("span",[e._v("\n          文件夹\n        ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:e.$t("table.compSize")},scopedSlots:e._u([{key:"default",fn:function(t){return[!0!==t.row.folder?i("span",[e._v(e._s(e.computedSize(t.row.files.fileSize)))]):e._e(),e._v(" "),!0===t.row.folder&&t.row.name?i("span",[e._v("--")]):e._e(),e._v(" "),t.row.newFolder?i("span",{staticStyle:{cursor:"pointer"},on:{click:e.cancelNewFolder}},[i("svg-icon",{attrs:{"icon-class":"cancel"}})],1):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"密级"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.computedSecret(t.row.secretClass)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"版本"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.version))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"120",label:"产品型号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.productNo))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"120",label:"文件图号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"文件类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.typeMap[t.row.type]))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"140",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"审核状态",width:"100",align:"center",filters:e.filiterStateList,"filter-method":e.filterState,prop:"state"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:e.computeStateClass(t.row)},[e._v("\n              "+e._s(e.computeAuditState(t.row))+"\n            ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.name?i("el-dropdown",{attrs:{trigger:"click"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更多操作",placement:"top"}},[i("span",{staticClass:"el-dropdown-link"},[i("svg-icon",{attrs:{"icon-class":"ellipsis"}})],1)]),e._v(" "),"preview"===e.forUse?i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.previewFile(t.row)}}},[e._v("预览")])])],1):i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.exportFile(t.row)}}},[e._v("下载")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:""}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.checkFileVersion(t.row)}}},[e._v("查看历史版本")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:""}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.applyToEdit(t.row)}}},[e._v("申请二次修改")])])],1)],1):e._e()]}}])})],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"尚未通过"}},["preview"!==e.forUse?i("div",{staticClass:"operationContainer",staticStyle:{height:"40px","border-bottom":"1px solid #ebeef5"}},[i("div",{staticStyle:{position:"absolute",top:"10px",left:"16px"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleCommit}},[e._v("提交审核")])],1),e._v(" "),i("div",{staticStyle:{float:"right",color:"rgb(0, 171, 235)",cursor:"pointer","padding-right":"20px"}},[i("span",{on:{click:e.handleuploadFile}},[i("svg-icon",{attrs:{"icon-class":"upload1"}}),e._v(" "),i("span",{staticStyle:{"font-size":"14px","margin-left":"6px"}},[e._v("上传文件")])],1)])]):e._e(),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticClass:"fileList",staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"正在加载库文件",fit:"","highlight-current-row":"",height:"700px","row-key":e.getRowKey},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",selectable:e.fileAuditSelection,"reserve-selection":!0,width:"55"}}),e._v(" "),i("el-table-column",{attrs:{label:"文件名","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[i("svg-icon",{staticStyle:{"font-size":"30px","margin-right":"10px",cursor:"pointer",color:"#26bada"},attrs:{"icon-class":e.classifyIcon(t.row)}}),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.name,placement:"top"}},[t.row.newFolder?e._e():i("span",{staticClass:"link-type",class:{repeatFile:t.row.repeat},staticStyle:{position:"relative",top:"2px",display:"inline-block",width:"70%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n              "+e._s(t.row.name)+"\n            ")])])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"种类",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===t.row.folder||t.row.newFolder?e._e():i("span",[e._v("\n          "+e._s(t.row.files.postfix)+"\n        ")]),e._v(" "),1!=t.row.folder||t.row.newFolder?e._e():i("span",[e._v("\n          文件夹\n        ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:e.$t("table.compSize")},scopedSlots:e._u([{key:"default",fn:function(t){return[!0!==t.row.folder?i("span",[e._v(e._s(e.computedSize(t.row.files.fileSize)))]):e._e(),e._v(" "),!0===t.row.folder&&t.row.name?i("span",[e._v("--")]):e._e(),e._v(" "),t.row.newFolder?i("span",{staticStyle:{cursor:"pointer"},on:{click:e.cancelNewFolder}},[i("svg-icon",{attrs:{"icon-class":"cancel"}})],1):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"密级"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.computedSecret(t.row.secretClass)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"版本"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.version))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"120",label:"产品型号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.productNo))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"120",label:"文件图号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"文件类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.typeMap[t.row.type]))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"140",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"审核状态",width:"100",align:"center",filters:e.filiterStateList,"filter-method":e.filterState,prop:"state"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:e.computeStateClass(t.row)},[e._v("\n          "+e._s(e.computeAuditState(t.row))+"\n        ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.name?i("el-dropdown",{attrs:{trigger:"click"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更多操作",placement:"top"}},[i("span",{staticClass:"el-dropdown-link"},[i("svg-icon",{attrs:{"icon-class":"ellipsis"}})],1)]),e._v(" "),"preview"===e.forUse?i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.previewFile(t.row)}}},[e._v("预览")])])],1):i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{disabled:e.computeBtnDisable(t.row,"delete")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.deleteFile(t.row)}}},[e._v("删除")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"download")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.exportFile(t.row)}}},[e._v("下载")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"modifyInfo")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.handleEditInfo(t.row)}}},[e._v("修改文件信息")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"edit")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.handleEditFile(t.row,"edit")}}},[e._v("修改文件")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"secondEdit")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.handleEditFile(t.row,"secondEdit")}}},[e._v("二次修改文件")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"apply")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.applyToEdit(t.row)}}},[e._v("申请二次修改")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"revoke")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.handleRevoke(t.row)}}},[e._v("撤销修改")])]),e._v(" "),i("el-dropdown-item",{attrs:{divided:"",disabled:e.computeBtnDisable(t.row,"changeVersion")}},[i("span",{staticStyle:{display:"inline-block",padding:"0 10px"},on:{click:function(i){e.handleRevokeSecond(t.row)}}},[e._v("更换版本")])])],1)],1):e._e()]}}])})],1)],1)],1),e._v(" "),i("el-dialog",{staticClass:"uploadDialog",attrs:{title:"上传文件",visible:e.uploadDialog,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":"",width:"50%"},on:{"update:visible":function(t){e.uploadDialog=t}}},[i("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"密级"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择密级"},on:{focus:e.checkUserInfo},model:{value:e.fileUpInfo.secretClass,callback:function(t){e.$set(e.fileUpInfo,"secretClass",t)},expression:"fileUpInfo.secretClass"}},e._l(e.computeSecretOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"类型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.fileUpInfo.type,callback:function(t){e.$set(e.fileUpInfo,"type",t)},expression:"fileUpInfo.type"}},e._l(e.typeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"产品型号"}},[i("el-input",{attrs:{placeholder:"请输入产品型号"},model:{value:e.fileUpInfo.productNo,callback:function(t){e.$set(e.fileUpInfo,"productNo",t)},expression:"fileUpInfo.productNo"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"文件图号"}},[i("el-input",{attrs:{placeholder:"请输入文件图号"},model:{value:e.fileUpInfo.fileNo,callback:function(t){e.$set(e.fileUpInfo,"fileNo",t)},expression:"fileUpInfo.fileNo"}})],1)],1),e._v(" "),"secondEdit"===e.uploadType?i("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"版本号"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择版本号"},model:{value:e.fileModify.version,callback:function(t){e.$set(e.fileModify,"version",t)},expression:"fileModify.version"}},e._l(e.computeVersionOption,function(e){return i("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}))],1)],1):e._e(),e._v(" "),"edit"===e.uploadType?i("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"审批流程"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择提交的目标审批流程"},model:{value:e.fileModify.ifToStart,callback:function(t){e.$set(e.fileModify,"ifToStart",t)},expression:"fileModify.ifToStart"}},e._l(e.ifToStartOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1):e._e(),e._v(" "),i("uploader",{directives:[{name:"loading",rawName:"v-loading",value:e.md5Loading,expression:"md5Loading"}],ref:"uploader",staticClass:"manage-uploader",attrs:{options:e.options,autoStart:e.autoStart,"file-status-text":e.statusText,"element-loading-text":"正在校验文件身份，请勿关闭"},on:{"file-complete":e.fileComplete,"files-added":e.checkMd5,"file-success":e.fileSuccess,"file-removed":e.fileRemove}},[i("uploader-unsupport"),e._v(" "),i("uploader-drop",[i("p",[e._v("在此处进行操作")]),e._v(" "),null!==e.fileUpInfo.secretClass&&null!==e.fileInfo.type&&null!==e.fileUpInfo.productNo&&null!==e.fileUpInfo.fileNo&&null!==e.fileUpInfo.subLibraryId&&""!==e.fileUpInfo.secretClass&&""!==e.fileInfo.type&&""!==e.fileUpInfo.productNo&&""!==e.fileUpInfo.fileNo&&""!==e.fileUpInfo.subLibraryId?i("uploader-btn",[e._v("选择文件")]):e._e()],1),e._v(" "),i("uploader-list",{ref:"uploaderList"}),e._v(" "),e.repeatFiles.length>0?i("div",{staticClass:"repeatFiles"},[i("el-table",{key:e.tableKey,attrs:{data:e.repeatFiles,"max-height":"300"}},[i("el-table-column",{attrs:{label:"重复文件列表"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{color:"#e6a23c"}},[e._v(e._s(t.row.name))])]}}])})],1)],1):e._e()],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["normal"!==e.uploadType&&e.showOnlyEdit?i("el-button",{attrs:{type:"primary"},on:{click:e.onlyModifyFileInfo}},[e._v("仅修改信息")]):e._e(),e._v(" "),e.hiddenClose?e._e():i("el-button",{on:{click:function(t){e.uploadDialog=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),i("el-dialog",{staticClass:"maniFileDialog",attrs:{title:"文件信息修改",visible:e.editInfoDialog,"append-to-body":"",width:"30%"},on:{"update:visible":function(t){e.editInfoDialog=t}}},[i("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"密级"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择密级"},model:{value:e.fileEditInfo.secretClass,callback:function(t){e.$set(e.fileEditInfo,"secretClass",t)},expression:"fileEditInfo.secretClass"}},e._l(e.computeSecretOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"类型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.fileEditInfo.type,callback:function(t){e.$set(e.fileEditInfo,"type",t)},expression:"fileEditInfo.type"}},e._l(e.typeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"产品型号"}},[i("el-input",{attrs:{placeholder:"请输入产品型号"},model:{value:e.fileEditInfo.productNo,callback:function(t){e.$set(e.fileEditInfo,"productNo",t)},expression:"fileEditInfo.productNo"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"文件图号"}},[i("el-input",{attrs:{placeholder:"请输入文件图号"},model:{value:e.fileEditInfo.fileNo,callback:function(t){e.$set(e.fileEditInfo,"fileNo",t)},expression:"fileEditInfo.fileNo"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.editInfoDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.editFileInfo}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{staticClass:"limit-width-dialog audit-dialog",attrs:{title:"选择审核人",visible:e.commitDialog,"append-to-body":"",width:"60%"},on:{"update:visible":function(t){e.commitDialog=t}}},[i("el-radio-group",{model:{value:e.signType,callback:function(t){e.signType=t},expression:"signType"}},[i("el-radio",{attrs:{label:1}},[e._v("无会签")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("一人会签通过")]),e._v(" "),i("el-radio",{attrs:{label:3}},[e._v("多人会签通过")])],1),e._v(" "),i("el-collapse",{staticClass:"audit-collapse",attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"选择核对人",name:"1"}},[i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.getMaLoading,expression:"getMaLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userList,"tooltip-effect":"dark"},on:{"selection-change":e.handleVerifySelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{label:"用户名","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.realName))]}}])})],1)],1)]),e._v(" "),i("el-collapse-item",{attrs:{title:"选择审核人",name:"2"}},[i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.getMaLoading,expression:"getMaLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userList,"tooltip-effect":"dark"},on:{"selection-change":e.handleAuditSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{label:"用户名","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.realName))]}}])})],1)],1)]),e._v(" "),2===e.signType||3===e.signType?i("el-collapse-item",{attrs:{title:"选择会签人",name:"3"}},[i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.getMaLoading,expression:"getMaLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.computeList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSignSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{label:"用户名","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.realName))]}}])})],1)],1)]):e._e(),e._v(" "),i("el-collapse-item",{attrs:{title:"选择批准人",name:"4"}},[i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.getMaLoading,expression:"getMaLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userList,"tooltip-effect":"dark"},on:{"selection-change":e.handleApproveSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{label:"用户名","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.realName))]}}])})],1)],1)])],1),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",loading:e.commitLoading},on:{click:e.commitToAuditor}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{staticClass:"selectVersion",attrs:{title:"选择需要回退的版本",visible:e.versionSelectDialog,"append-to-body":"",width:"30%"},on:{"update:visible":function(t){e.versionSelectDialog=t}}},[i("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"选择版本"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择回退的版本"},model:{value:e.switchVersion,callback:function(t){e.switchVersion=t},expression:"switchVersion"}},e._l(e.switchVersionOptions,function(e){return i("el-option",{key:e.id,attrs:{label:e.version,value:e.version}})}))],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.versionSelectDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.revokeSecondEdit}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{staticClass:"maniFileDialog",attrs:{title:"文件信息修改",visible:e.historyFileDialog,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.historyFileDialog=t}}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.historyLoading,expression:"historyLoading"}],staticClass:"fileList",staticStyle:{width:"100%"},attrs:{data:e.historyFiles,"element-loading-text":"正在加载文件历史版本",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"文件名","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[i("svg-icon",{staticStyle:{"font-size":"30px","margin-right":"10px",cursor:"pointer",color:"#26bada"},attrs:{"icon-class":e.classifyIcon(t.row)}}),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.name,placement:"top"}},[t.row.newFolder?e._e():i("span",{staticClass:"link-type",class:{repeatFile:t.row.repeat},staticStyle:{position:"relative",top:"2px",display:"inline-block",width:"70%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n                  "+e._s(t.row.name)+"\n                ")])])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"种类",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v("\n            "+e._s(t.row.files.postfix)+"\n          ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:e.$t("table.compSize")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.computedSize(t.row.files.fileSize)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"密级"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.computedSecret(t.row.secretClass)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",label:"版本"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.version))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"120",label:"产品型号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.productNo))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"120",label:"文件图号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"140",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"140",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.exportFile(t.row)}}},[e._v("下载")])]}}])})],1)],1)],1)},staticRenderFns:[]};var b=i("VU/8")(g,y,!1,function(e){i("AKbO")},"data-v-1d831a52",null);t.default=b.exports}});