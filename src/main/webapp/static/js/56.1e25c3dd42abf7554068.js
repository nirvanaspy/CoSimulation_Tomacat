webpackJsonp([56],{HsQf:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.show-pwd[data-v-364b8caf] {\n  position: absolute;\n  right: 10px;\n  top: 2px;\n  font-size: 16px;\n  cursor: pointer;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.project-container[data-v-364b8caf] {\n  position: fixed;\n  height: 100%;\n  width: 100%;\n  background-color: #2d3a4b;\n}\n.project-container .login-form[data-v-364b8caf] {\n    height: 100%;\n    position: absolute;\n    left: 0;\n    right: 0;\n    width: 60%;\n    padding: 0px 35px 15px 35px;\n    margin: 10px auto;\n}\n.project-container .svg-container[data-v-364b8caf] {\n    padding: 6px 5px 6px 15px;\n    color: #889aa4;\n    vertical-align: middle;\n    width: 30px;\n    display: inline-block;\n}\n.project-container .svg-container_login[data-v-364b8caf], .project-container .svg-container_ip[data-v-364b8caf] {\n      font-size: 20px;\n}\n.project-container .title-container[data-v-364b8caf] {\n    position: relative;\n}\n.project-container .title-container .title[data-v-364b8caf] {\n      font-size: 26px;\n      font-weight: 400;\n      color: #eee;\n      margin: 0px auto 40px auto;\n      text-align: center;\n      font-weight: bold;\n}\n.project-container .title-container .set-language[data-v-364b8caf] {\n      color: #fff;\n      position: absolute;\n      top: 5px;\n      right: 0px;\n}\n.right-menu[data-v-364b8caf] {\n  float: right;\n  height: 100%;\n}\n.right-menu[data-v-364b8caf]:focus {\n    outline: none;\n}\n.right-menu .right-menu-item[data-v-364b8caf] {\n    display: inline-block;\n    margin: 0 8px;\n}\n.right-menu .avatar-container[data-v-364b8caf] {\n    height: 50px;\n    margin-right: 30px;\n}\n.right-menu .avatar-container .avatar-wrapper[data-v-364b8caf] {\n      cursor: pointer;\n      margin-top: 5px;\n      position: relative;\n}\n.right-menu .avatar-container .avatar-wrapper .user-avatar[data-v-364b8caf] {\n        width: 40px;\n        height: 40px;\n        border-radius: 10px;\n}\n.right-menu .avatar-container .avatar-wrapper .el-icon-caret-bottom[data-v-364b8caf] {\n        position: absolute;\n        right: -20px;\n        top: 25px;\n        font-size: 12px;\n}\n",""])},JOy5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("BO1k"),n=i.n(a),o=i("woOf"),s=i.n(o),r=i("kCe2"),l=i("E4LH"),d=i("EMlb"),c=i("XlQU"),p=i("IcnI"),u={components:{PanThumb:r.a},name:"login",data:function(){var t=this;return{userId:"",userName:"",selectedId:"",tableKey:0,list:[],listQuery:{page:0,size:10,limit:5,tagname:""},total:null,pagesize:10,currentPage:1,searchQuery:"",dialogFormVisible:!1,modifyPasswordVisible:!1,modPasLoading:!1,passwordType:"password",passwordTypeAgain:"password",btnConfirm:!1,passwordValidate:!1,pasAgainValidate:!1,formLabelWidth:"100px",temp:{id:"",name:"",description:""},form:{passwordNew:"",passwordAgain:""},dialogStatus:"",textMap:{update:"编辑",create:"新建"},rules:{name:[{required:!0,message:"请输入工程名！",trigger:"blur"}]},modifyRules:{passwordNew:[{required:!0,trigger:"blur",validator:function(e,i,a){Object(l.a)(i)?(a(),t.passwordValidate=!0,t.passwordValidate&&t.pasAgainValidate&&(t.btnConfirm=!1)):(a(new Error("密码必须是6-16位数字和字母的组合！")),t.btnConfirm=!0,t.passwordValidate=!1)}}],passwordAgain:[{required:!0,trigger:"blur",validator:function(e,i,a){Object(l.a)(i)?t.form.passwordAgain!==t.form.passwordNew?(t.btnConfirm=!0,t.pasAgainValidate=!1,a(new Error("两次密码输入不一致，请再次输入新密码！"))):(a(),t.pasAgainValidate=!0,t.passwordValidate&&t.pasAgainValidate&&(t.btnConfirm=!1)):(a(new Error("密码必须是6-16位数字和字母的组合！")),t.btnConfirm=!0,t.pasAgainValidate=!1)}}]},loading:!1,listLoading:!0,creProLoading:!1,ediuserLoading:!1,delLoading:!1,showDialog:!1,userData:{username:"",password:""},token:"",role:"",errorMessage:"操作失败！",hisBtnLoading:!1,isHistory:!1}},created:function(){this.role=p.a.getters.roles,this.userId=this.getCookie("userId"),this.userName=this.getCookie("username"),this.getList()},methods:{showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},showPwdAgain:function(){"password"===this.passwordTypeAgain?this.passwordTypeAgain="":this.passwordTypeAgain="password"},logout:function(){this.$store.dispatch("FedLogOut").then(function(){location.reload()})},getUserInfo:function(){var t=this;Object(c.i)().then(function(e){t.userId=e.data.data.id,t.userName=e.data.data.username})},getList:function(){var t=this;this.listLoading=!0,"admin"==this.role?Object(d.h)(this.listQuery).then(function(e){t.list=e.data.data.content,t.listLoading=!1,t.listLength=e.data.data.length,t.total=e.data.data.totalElements}):"editor"==this.role&&Object(d.j)(this.userId,this.listQuery).then(function(e){t.list=e.data.data.content,t.listLoading=!1,t.listLength=e.data.data.length,t.total=e.data.data.totalElements})},resetTemp:function(){this.temp={id:"",name:"",description:""}},handleCreate:function(t){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,t.target.loading=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},createData:function(){var t=this,e=i("mw3O");this.$refs.dataForm.validate(function(i){if(t.creProLoading=!0,i){var a={name:t.temp.name,description:t.temp.description},n=e.stringify(a);Object(d.c)(n,t.userId).then(function(){t.creProLoading=!1,t.list.unshift(t.temp),t.dialogFormVisible=!1,t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),t.getList()}).catch(function(e){t.creProLoading=!1,t.errorMessage="操作失败！",e.response.data.message&&(t.errorMessage=e.response.data.message),t.$notify({title:"失败",message:t.errorMessage,type:"error",duration:2e3})})}})},handleUpdate:function(t){var e=this;this.selectedId=t.id,this.temp=s()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},updateData:function(){var t=this,e=i("mw3O");this.$refs.dataForm.validate(function(i){if(i){t.creProLoading=!0;var a={name:t.temp.name,description:t.temp.description},o=t.selectedId;console.log("改前改后-----------");var s=e.stringify(a);Object(d.r)(s,o).then(function(){t.creProLoading=!1;var e=!0,i=!1,a=void 0;try{for(var o,s=n()(t.list);!(e=(o=s.next()).done);e=!0){var r=o.value;if(r.id===t.temp.id){var l=t.list.indexOf(r);t.list.splice(l,1,t.temp);break}}}catch(t){i=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw a}}t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})}).catch(function(e){t.creProLoading=!1,t.errorMessage="操作失败！",e.response.data.message&&(t.errorMessage=e.response.data.message),t.$notify({title:"失败",message:t.errorMessage,type:"error",duration:2e3})})}})},handleDelete:function(t){var e=this,i=t.id;t.delLoading=!0,this.$confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.d)(i).then(function(){t.delLoading=!1,e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),e.getList()}).catch(function(){t.delLoading=!1,e.$notify({title:"失败",message:"删除失败",type:"error",duration:2e3})})}).catch(function(){t.delLoading=!1,e.$message({type:"info",message:"已取消删除"})})},handleModifyPassword:function(){var t=this;this.resetModify(),this.modifyPasswordVisible=!0,this.modPasLoading=!1,this.$nextTick(function(){t.$refs.modifyPassForm.clearValidate()})},resetModify:function(){this.form={passwordAgain:"",passwordNew:""}},modifyPassword:function(){var t=this;this.$refs.modifyPassForm.validate(function(e){if(e){t.modPasLoading=!0;var a={password:t.form.passwordNew},n=i("mw3O").stringify(a);Object(c.m)(n,t.userId).then(function(){t.modPasLoading=!1,t.modifyPasswordVisible=!1,t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),t.$store.dispatch("FedLogOut").then(function(){location.reload()})}).catch(function(){t.modPasLoading=!1,t.$notify({title:"失败",message:"修改失败",type:"error",duration:2e3})})}})},handleSelect:function(t){this.$store.commit("SET_PROJECTID",t.id),this.$store.commit("SET_PROJECTNAME",t.name),this.$router.push({path:"/dashboard/dashboard"})},handleSizeChange:function(t){this.listQuery.size=t,this.pagesize=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t-1,this.currentPage=t,this.getList()},showHistory:function(){var t=this;this.listLoading=!0,this.hisBtnLoading=!0,"admin"==this.role?Object(d.i)(this.listQuery).then(function(e){t.isHistory=!0,t.list=e.data.data.content,t.total=e.data.total,t.listLoading=!1,t.hisBtnLoading=!1}).catch(function(){t.listLoading=!1,t.hisBtnLoading=!1,t.$notify({title:"失败",message:"操作失败！",type:"error",duration:"2000"})}):"editor"==this.role&&Object(d.k)(this.userId,this.listQuery).then(function(e){t.isHistory=!0,t.list=e.data.data.content,t.listLoading=!1,t.listLength=e.data.data.length,t.total=e.data.data.totalElements,t.hisBtnLoading=!1}).catch(function(){t.listLoading=!1,t.hisBtnLoading=!1,t.$notify({title:"失败",message:"操作失败！",type:"error",duration:"2000"})})},showNow:function(){var t=this;this.listLoading=!0,this.hisBtnLoading=!0,"admin"==this.role?Object(d.h)(this.listQuery).then(function(e){t.list=e.data.data.content,t.total=e.data.total,t.listLoading=!1,t.hisBtnLoading=!1,t.isHistory=!1}).catch(function(){t.listLoading=!1,t.hisBtnLoading=!1,t.$notify({title:"失败",message:"操作失败！",type:"error",duration:"2000"})}):"editor"==this.role&&Object(d.j)(this.userId,this.listQuery).then(function(e){t.list=e.data.data.content,t.listLoading=!1,t.hisBtnLoading=!1,t.listLength=e.data.data.length,t.total=e.data.data.totalElements,t.isHistory=!1}).catch(function(){t.listLoading=!1,t.hisBtnLoading=!1,t.$notify({title:"失败",message:"操作失败！",type:"error",duration:"2000"})})},handleDelHisPro:function(t){var e=this;this.$confirm("确认彻底删除此工程吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.listLoading=!0,Object(d.b)(t.id).then(function(){e.listLoading=!1,e.showHistory(),e.$notify({title:"成功",message:"清除成功！",type:"success",duration:2e3})}).catch(function(){e.listLoading=!1,e.$notify({title:"失败",message:"清除失败！",type:"error",duration:2e3})})}).catch(function(){e.$message({type:"info",message:"已取消清除"})})},handleResHisPro:function(t){var e=this;this.$confirm("确认恢复此工程吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.listLoading=!0,Object(d.l)(t.id).then(function(){e.listLoading=!1,e.showHistory(),e.$notify({title:"成功",message:"恢复成功！",type:"success",duration:2e3})}).catch(function(){e.listLoading=!1,e.$notify({title:"失败",message:"恢复失败！",type:"error",duration:2e3})})}).catch(function(){e.$message({type:"info",message:"已取消恢复"})})}},computed:{listA:function(){var t=this;return t.list.filter(function(e){return-1!==e.name.toLowerCase().indexOf(t.searchQuery.toLowerCase())})}},mounted:function(){history.pushState(null,null,document.URL),window.addEventListener("popstate",function(){history.pushState(null,null,document.URL)})}},g={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"project-container"},[i("el-header",[i("div",{staticClass:"right-menu"},[i("span",{staticStyle:{position:"relative",top:"-12px",color:"#fff"},attrs:{calss:"userName"}},[t._v(t._s(t.userName))]),t._v(" "),i("el-dropdown",{staticClass:"avatar-container right-menu-item",attrs:{trigger:"click"}},[i("div",{staticClass:"avatar-wrapper"},[i("pan-thumb",{staticClass:"proImg",attrs:{width:"40px",height:"40px",image:"./2/png"}}),t._v(" "),i("i",{staticClass:"el-icon-caret-bottom"})],1),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",["admin"===t.role?i("span",{staticStyle:{display:"block"}},[i("router-link",{attrs:{to:"/user_manage"}},[t._v("用户管理")])],1):i("span",{staticStyle:{display:"block"},on:{click:t.handleModifyPassword}},[t._v("修改密码")])]),t._v(" "),i("el-dropdown-item",{attrs:{divided:""}},[i("span",{staticStyle:{display:"block"},on:{click:t.logout}},[t._v(t._s(t.$t("navbar.logOut")))])])],1)],1)],1)]),t._v(" "),i("div",{staticClass:"login-form",attrs:{id:"project-table"}},[i("div",{staticClass:"title-container"},[i("h3",{staticClass:"title",staticStyle:{"margin-bottom":"30px"}},[t.isHistory?i("span",[t._v("项目管理回收站")]):i("span",[t._v("项目管理")])]),t._v(" "),i("div",[i("div",{staticClass:"searchContainer",staticStyle:{display:"inline-block","margin-bottom":"16px"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"项目名"},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}})],1),t._v(" "),"editor"!=this.role||t.isHistory?t._e():i("el-button",{staticStyle:{float:"right","margin-top":"2px","margin-left":"8px"},attrs:{size:"mini",type:"success"},on:{click:function(e){t.handleCreate(e)}}},[t._v("添加\n        ")]),t._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isHistory,expression:"!isHistory"}],staticStyle:{float:"right","margin-top":"2px"},attrs:{size:"mini",type:"primary",icon:"el-icon-delete",loading:t.hisBtnLoading},on:{click:t.showHistory}},[t._v("\n          回收站\n        ")]),t._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isHistory,expression:"isHistory"}],staticStyle:{float:"right","margin-top":"2px"},attrs:{size:"mini",type:"primary",icon:"el-icon-back",loading:t.hisBtnLoading},on:{click:t.showNow}},[t._v("\n          返回\n        ")])],1)]),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%","border-radius":"8px"},attrs:{data:t.listA,"element-loading-text":"给我一点时间",fit:"","highlight-current-row":"",height:"65%"}},[i("el-table-column",{attrs:{"min-width":"150px",label:t.$t("table.projectName")},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isHistory?t._e():i("span",{staticClass:"link-type",on:{click:function(i){t.handleSelect(e.row)}}},[t._v(t._s(e.row.name))]),t._v(" "),t.isHistory?i("span",[t._v(t._s(e.row.name))]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"150px",label:t.$t("table.projectDesc")},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.description))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:t.$t("table.actions"),width:"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isHistory?t._e():i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.handleUpdate(e.row)}}},[t._v(t._s(t.$t("table.edit")))]),t._v(" "),t.isHistory?t._e():i("el-button",{attrs:{size:"mini",type:"danger",loading:e.row.delLoading},on:{click:function(i){t.handleDelete(e.row)}}},[t._v(t._s(t.$t("table.delete")))]),t._v(" "),t.isHistory?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.handleResHisPro(e.row)}}},[t._v("恢复")]):t._e(),t._v(" "),t.isHistory?i("el-button",{attrs:{size:"mini",type:"danger",loading:e.row.delLoading},on:{click:function(i){t.handleDelHisPro(e.row)}}},[t._v("清除")]):t._e()]}}])})],1),t._v(" "),i("el-pagination",{staticStyle:{"text-align":"center","margin-top":"20px"},attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:this.total,background:""},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"append-to-body":"",width:"40%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"dataForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{rules:t.rules,model:t.temp}},[i("el-form-item",{attrs:{label:t.$t("table.projectName"),prop:"name","label-width":t.formLabelWidth}},[i("el-input",{model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name",e)},expression:"temp.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("table.projectDesc"),prop:"description","label-width":t.formLabelWidth}},[i("el-input",{model:{value:t.temp.description,callback:function(e){t.$set(t.temp,"description",e)},expression:"temp.description"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),"create"==t.dialogStatus?i("el-button",{attrs:{type:"primary",loading:t.creProLoading},on:{click:t.createData}},[t._v(t._s(t.$t("table.confirm")))]):i("el-button",{attrs:{type:"primary",loading:t.creProLoading},on:{click:t.updateData}},[t._v(t._s(t.$t("table.confirm")))])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改密码",visible:t.modifyPasswordVisible,"append-to-body":"",width:"40%"},on:{"update:visible":function(e){t.modifyPasswordVisible=e}}},[i("el-form",{ref:"modifyPassForm",staticStyle:{width:"80%",margin:"0 auto"},attrs:{model:t.form,rules:t.modifyRules}},[i("el-form-item",{attrs:{label:"新密码","label-width":t.formLabelWidth,prop:"passwordNew"}},[i("el-input",{attrs:{type:t.passwordType,"auto-complete":"off"},model:{value:t.form.passwordNew,callback:function(e){t.$set(t.form,"passwordNew",e)},expression:"form.passwordNew"}}),t._v(" "),i("span",{staticClass:"show-pwd",on:{click:t.showPwd}},[i("svg-icon",{attrs:{"icon-class":"eye"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"再次输入","label-width":t.formLabelWidth,prop:"passwordAgain"}},[i("el-input",{attrs:{type:t.passwordTypeAgain,"auto-complete":"off"},model:{value:t.form.passwordAgain,callback:function(e){t.$set(t.form,"passwordAgain",e)},expression:"form.passwordAgain"}}),t._v(" "),i("span",{staticClass:"show-pwd",on:{click:t.showPwdAgain}},[i("svg-icon",{attrs:{"icon-class":"eye"}})],1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.modifyPasswordVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{disabled:this.btnConfirm,type:"primary",loading:t.modPasLoading},on:{click:t.modifyPassword}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var h=i("VU/8")(u,g,!1,function(t){i("ts7O")},"data-v-364b8caf",null);e.default=h.exports},ts7O:function(t,e,i){var a=i("HsQf");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("02e23264",a,!0)}});